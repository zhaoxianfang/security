<p align="center"><a href="https://www.yoc.cn" target="_blank"><img src="./docs/images/security.png" width="100%" alt="Security"></a></p>

# Laravel Security - Laravel é¡¹ç›®å®‰å…¨æ‹¦æˆªåŒ…

<p align="center">
    <a href="https://packagist.org/packages/zxf/security"><img src="https://img.shields.io/packagist/v/zxf/security?style=flat-square&logo=composer&logoColor=orange" alt="Version"></a>
    <a href="https://github.com/zhaoxianfang/security"><img src="https://img.shields.io/packagist/dt/zxf/security?logo=github&logoColor=white&style=flat-square" alt="Total Downloads"></a>
    <a href="https://www.php.net/"><img src="https://img.shields.io/packagist/php-v/zxf/security?style=flat-square&logo=php" alt="PHP Version"></a>
    <a href="https://github.com/zhaoxianfang/security"><img src="https://img.shields.io/github/release/zhaoxianfang/util.svg" alt="Release"></a>
    <a href="https://packagist.org/packages/zxf/security"><img src="https://img.shields.io/packagist/l/zxf/security?logo=bookstack&logoColor=white&style=flat-square" alt="License"></a>
    <a href="https://www.yoc.cn"><img src="https://img.shields.io/badge/docs-yoc.cn-blue" alt="Documentation"></a>
</p>

---

`zxf/security` æ˜¯ä¸€ä¸ªä¼ä¸šçº§ã€å•†ä¸šçº§çš„å®‰å…¨é˜²æŠ¤ä¸­é—´ä»¶åŒ…ï¼Œä¸º Laravel åº”ç”¨æä¾›å…¨æ–¹ä½ã€é«˜æ€§èƒ½ã€ä½è¯¯æŠ¥ç‡çš„å®‰å…¨é˜²æŠ¤èƒ½åŠ›ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ›¡ï¸ ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤
- **16å±‚é˜²å¾¡ä½“ç³»**ï¼šIPé»‘ç™½åå•ã€é€Ÿç‡é™åˆ¶ã€SQLæ³¨å…¥ã€XSSã€å‘½ä»¤æ³¨å…¥ç­‰å…¨é¢è¦†ç›–
- **æ™ºèƒ½å¨èƒæ£€æµ‹**ï¼šè‡ªåŠ¨è¯†åˆ«å’Œè¯„åˆ†å¨èƒIPï¼ŒåŠ¨æ€è°ƒæ•´é˜²æŠ¤ç­–ç•¥
- **è‡ªé€‚åº”å°ç¦**ï¼šæ ¹æ®å¨èƒè¯„åˆ†è‡ªåŠ¨è°ƒæ•´å°ç¦æ—¶é•¿ï¼Œé«˜æ•ˆé˜»æŒ¡æŒç»­æ”»å‡»è€…
- **å•†ä¸šçº§å¨èƒåº“**ï¼šå†…ç½® 1000+ æ”»å‡»æ¨¡å¼ï¼Œè¦†ç›– SQLæ³¨å…¥ã€XSSã€å‘½ä»¤æ³¨å…¥ã€æ–‡ä»¶ä¸Šä¼ ç­‰å¤šç§æ”»å‡»å‘é‡

### âš¡ é«˜æ€§èƒ½ä¼˜åŒ–
- **æ­£åˆ™è¡¨è¾¾å¼é¢„ç¼–è¯‘**ï¼šå¤§å¹…æå‡åŒ¹é…é€Ÿåº¦ï¼Œæ€§èƒ½ä¼˜åŒ– 66.7%
- **æ™ºèƒ½ç¼“å­˜æœºåˆ¶**ï¼šå¤šå±‚ç¼“å­˜ç­–ç•¥ï¼Œå‡å°‘é‡å¤è®¡ç®—
- **è¯¯æŠ¥æ™ºèƒ½è¿‡æ»¤**ï¼šå¤šå±‚è¿‡æ»¤æœºåˆ¶ï¼Œè¯¯æŠ¥ç‡é™ä½ 90%
- **é…ç½®çƒ­é‡è½½**ï¼šé…ç½®ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯åº”ç”¨

### ğŸ¯ ç²¾ç»†åŒ–æ§åˆ¶
- **ç™½åå•åˆ†çº§ç®¡ç†**ï¼šæ”¯æŒ low/medium/high ä¸‰çº§å®‰å…¨çº§åˆ«ï¼Œç²¾ç¡®æ§åˆ¶å®‰å…¨æ£€æŸ¥
- **é˜²å¾¡å±‚ç‹¬ç«‹é…ç½®**ï¼š14ä¸ªé˜²å¾¡å±‚å¯ç‹¬ç«‹å¼€å…³ï¼Œçµæ´»é€‚é…ä¸åŒä¸šåŠ¡åœºæ™¯
- **åŠ¨æ€é…ç½®æº**ï¼šæ”¯æŒæ•°ç»„ã€ç±»æ–¹æ³•ã€é—­åŒ…ã€å­—ç¬¦ä¸²ç­‰å¤šç§é…ç½®æ–¹å¼
- **è‡ªå®šä¹‰è§„åˆ™å¼•æ“**ï¼šæ”¯æŒè‡ªå®šä¹‰æ£€æµ‹è§„åˆ™å’Œå¤„ç†å™¨

### ğŸ”§ å¼€å‘è€…å‹å¥½
- **å¼€ç®±å³ç”¨**ï¼šå‘å¸ƒé…ç½®æ–‡ä»¶åé›¶é…ç½®å¯åŠ¨å…¨å±€é˜²æŠ¤
- **å®Œå–„ä¸­æ–‡æ³¨é‡Š**ï¼šæ‰€æœ‰é…ç½®é¡¹å’Œä»£ç éƒ½æœ‰è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š
- **è¯¦ç»†æ—¥å¿—è®°å½•**ï¼šæ”¯æŒå¤šçº§åˆ«æ—¥å¿—å’Œè¯¦ç»†æ¨¡å¼ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥
- **å¼‚å¸¸ä¿æŠ¤æœºåˆ¶**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†ï¼Œå¼‚å¸¸æ—¶å¯é…ç½®æ”¾è¡Œæˆ–æ‹¦æˆª

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”è¡¨

| åŠŸèƒ½ç‰¹æ€§   | zxf/security | å…¶ä»–å®‰å…¨åŒ…   | ä¼˜åŠ¿  |
|--------|--------------|---------|-----|
| é˜²å¾¡å±‚æ•°é‡  | 16å±‚          | 6-10å±‚   | æ›´å…¨é¢ |
| å¨èƒæ£€æµ‹æ¨¡å¼ | 1000+        | 200-500 | æ›´å…¨é¢ |
| ç™½åå•åˆ†çº§  | âœ“ (3çº§)       | âœ—       | æ›´ç²¾ç»† |
| è‡ªé€‚åº”å°ç¦  | âœ“            | âœ—       | æ›´æ™ºèƒ½ |
| é…ç½®çƒ­é‡è½½  | âœ“            | âœ—       | æ›´ä¾¿æ· |
| è¯¯æŠ¥è¿‡æ»¤   | âœ“ (å¤šå±‚)       | éƒ¨åˆ†æ”¯æŒ    | æ›´å‡†ç¡® |
| ä¸­æ–‡æ³¨é‡Š   | âœ“ (å…¨è¦†ç›–)      | éƒ¨åˆ†æˆ–æ—     | æ›´å‹å¥½ |
| æ€§èƒ½ä¼˜åŒ–   | âœ“ (66.7%)    | åŸºç¡€ä¼˜åŒ–    | æ›´é«˜æ•ˆ |

## ğŸ“¦ å®‰è£…

```bash
composer require zxf/security
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‘å¸ƒé…ç½®æ–‡ä»¶

```bash
# ä¸€é”®å®‰è£…ï¼ˆæ¨èï¼‰
php artisan security:install

# å¼ºåˆ¶å®‰è£…ï¼ˆè¦†ç›–ç°æœ‰æ–‡ä»¶ï¼‰
php artisan security:install --force

# å®‰è£…ä½†ä¸è¿è¡Œè¿ç§»
php artisan security:install --no-migrate

# ä»…å‘å¸ƒé…ç½®æ–‡ä»¶
php artisan vendor:publish --tag=security-config

# ä»…å‘å¸ƒæ•°æ®è¿ç§»
php artisan vendor:publish --tag=security-migrations
```

### 2. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
php artisan migrate
```

### 3. é…ç½®å®‰å…¨ä¸­é—´ä»¶

```php
// config/security.php

// å…¨å±€é˜²æŠ¤ï¼ˆæ¨èï¼‰
'enabled' => true,
'enabled_type' => 'global',

// æˆ–è€…è·¯ç”±çº§é˜²æŠ¤
'enabled_type' => 'route',
```

### 4. åœ¨è·¯ç”±ä¸­ä½¿ç”¨ï¼ˆå¦‚æœé€‰æ‹©è·¯ç”±çº§é˜²æŠ¤ï¼‰

```php
// åœ¨è·¯ç”±ä¸­æ·»åŠ ä¸­é—´ä»¶
Route::middleware(['security'])->group(function () {
    Route::get('/api', [ApiController::class, 'index']);
});

// æ’é™¤ç‰¹å®šè·¯ç”±
Route::withoutMiddleware(['security'])->get('/health', [HealthController::class, 'check']);
```

> ğŸ‰ **å°±è¿™ä¹ˆç®€å•ï¼** å‘å¸ƒé…ç½®æ–‡ä»¶åï¼Œå…¨å±€æ¨¡å¼ä¸‹æ— éœ€ä»»ä½•ä»£ç ä¿®æ”¹å³å¯äº«å—å…¨é¢çš„å®‰å…¨é˜²æŠ¤ã€‚

## ğŸ“– æ–‡æ¡£

- **[é…ç½®æŒ‡å—](docs/CONFIGURATION_GUIDE.md)** - å®Œæ•´çš„é…ç½®é¡¹è¯´æ˜ä¸ä½¿ç”¨æŒ‡å—
- **[æ¶æ„æŒ‡å—](docs/ARCHITECTURE_GUIDE.md)** - ç³»ç»Ÿæ¶æ„ã€ç»„ä»¶è®¾è®¡å’Œå·¥ä½œæµç¨‹è¯¦è§£
- **[å®‰å…¨æœ€ä½³å®è·µ](docs/SECURITY_BEST_PRACTICES.md)** - ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®ä¸æœ€ä½³å®è·µæŒ‡å—
- **[é”™è¯¯å¤„ç†ä¸æ•…éšœæ’æŸ¥](docs/ERROR_HANDLING_AND_TROUBLESHOOTING.md)** - å¼‚å¸¸å¤„ç†å’Œé—®é¢˜è§£å†³æŒ‡å—

## ğŸ”’ å®‰å…¨åŠŸèƒ½æ¸…å•

### 1ï¸âƒ£ åŸºç¡€å®‰å…¨æ§åˆ¶
- âœ… å¼€å…³æ§åˆ¶ï¼šå…¨å±€å¯ç”¨/ç¦ç”¨å®‰å…¨ä¸­é—´ä»¶
- âœ… è¿è¡Œæ¨¡å¼ï¼šå…¨å±€é˜²æŠ¤æˆ–è·¯ç”±çº§é˜²æŠ¤
- âœ… æœ¬åœ°ç¯å¢ƒè±å…ï¼šå¯é€‰å¿½ç•¥æœ¬åœ°ç¯å¢ƒè¯·æ±‚
- âœ… æ—¥å¿—è®°å½•ï¼šå¯é…ç½®ä¸åŒçº§åˆ«çš„å®‰å…¨äº‹ä»¶æ—¥å¿—

### 2ï¸âƒ£ è®¿é—®é¢‘ç‡æ§åˆ¶
- âœ… é€Ÿç‡é™åˆ¶ï¼šé˜²æ­¢æš´åŠ›ç ´è§£å’ŒDDoSæ”»å‡»
- âœ… å¤šæ—¶é—´çª—å£ï¼šåˆ†é’Ÿã€å°æ—¶ã€å¤©çº§åˆ«çš„è¯·æ±‚é¢‘ç‡é™åˆ¶
- âœ… æŒ‡çº¹è¯†åˆ«ç­–ç•¥ï¼šIPã€IP+UAã€IP+UA+Pathã€è‡ªå®šä¹‰
- âœ… æ»‘åŠ¨çª—å£ç®—æ³•ï¼šç²¾ç¡®æ§åˆ¶è¯·æ±‚é¢‘ç‡

### 3ï¸âƒ£ IPæ™ºèƒ½ç®¡ç†
- âœ… è‡ªåŠ¨å¨èƒæ£€æµ‹ï¼šè‡ªåŠ¨è¯†åˆ«å¯ç–‘IPå¹¶è¯„åˆ†ï¼ˆ0-100ï¼‰
- âœ… åŠ¨æ€é»‘åå•ï¼šå¨èƒè¯„åˆ†è¾¾æ ‡æ—¶è‡ªåŠ¨åŠ å…¥é»‘åå•
- âœ… æ™ºèƒ½è¯„åˆ†ç³»ç»Ÿï¼šæ ¹æ®è¡Œä¸ºåŠ¨æ€è°ƒæ•´å¨èƒè¯„åˆ†
- âœ… è‡ªé€‚åº”å°ç¦ï¼šæ ¹æ®å¨èƒè¯„åˆ†åŠ¨æ€è°ƒæ•´å°ç¦æ—¶é•¿
- âœ… è¯„åˆ†è¡°å‡ï¼šæ¯å°æ—¶è‡ªåŠ¨é™ä½å¨èƒè¯„åˆ†ï¼Œå…è®¸IP"æ”¹è¿‡"

### 4ï¸âƒ£ è¯·æ±‚æ–¹æ³•éªŒè¯
- âœ… åˆæ³•æ–¹æ³•æ£€æŸ¥ï¼šåªå…è®¸é¢„è®¾çš„HTTPæ–¹æ³•è®¿é—®
- âœ… å¯ç–‘æ–¹æ³•è¯†åˆ«ï¼šæ‹¦æˆªCONNECTã€TRACEç­‰å±é™©æ–¹æ³•

### 5ï¸âƒ£ è¯·æ±‚å†…å®¹å®‰å…¨æ‰«æ
- âœ… æ¶æ„å†…å®¹æ£€æµ‹ï¼š1000+ æ­£åˆ™æ¨¡å¼è¦†ç›–å„ç±»æ”»å‡»
- âœ… ç™½åå•æœºåˆ¶ï¼šç‰¹å®šè·¯å¾„å¯è·³è¿‡å†…å®¹æ£€æŸ¥
- âœ… é•¿åº¦é˜ˆå€¼æ§åˆ¶ï¼šåªå¯¹è¾¾åˆ°ä¸€å®šé•¿åº¦çš„å†…å®¹è¿›è¡Œæ£€æµ‹
- âœ… åŠ¨æ€é…ç½®æºï¼šæ”¯æŒç±»æ–¹æ³•ã€é—­åŒ…ã€æ•°ç»„ç­‰å¤šç§é…ç½®æ–¹å¼

### 6ï¸âƒ£ URLè·¯å¾„å®‰å…¨
- âœ… éæ³•è·¯å¾„æ£€æµ‹ï¼šæ£€æµ‹å¹¶æ‹¦æˆªåŒ…å«éæ³•å­—ç¬¦çš„URL
- âœ… ç™½åå•è·¯å¾„ï¼šæ”¯æŒå­—ç¬¦ä¸²å’Œå¤æ‚å¯¹è±¡æ ¼å¼
- âœ… åˆ†çº§å®‰å…¨æ§åˆ¶ï¼šlow/medium/high ä¸‰çº§å®‰å…¨çº§åˆ«
- âœ… æ–¹æ³•é™åˆ¶ï¼šå¯é™åˆ¶ç™½åå•è·¯å¾„çš„HTTPæ–¹æ³•
- âœ… é•¿åº¦é™åˆ¶ï¼šé™åˆ¶æœ€å¤§URLé•¿åº¦ï¼Œé˜²æ­¢ç¼“å†²åŒºæ”»å‡»

### 7ï¸âƒ£ å®¢æˆ·ç«¯è¯†åˆ«æ§åˆ¶
- âœ… User-Agentæ£€æŸ¥ï¼šè¯†åˆ«å¹¶æ‹¦æˆªå¯ç–‘çš„User-Agent
- âœ… ç™½åå•çˆ¬è™«ï¼šå…è®¸åˆæ³•çš„æœç´¢å¼•æ“çˆ¬è™«è®¿é—®
- âœ… ç©ºUAæ§åˆ¶ï¼šå¯é…ç½®æ˜¯å¦å…è®¸æ— User-Agentçš„è¯·æ±‚
- âœ… é•¿åº¦é™åˆ¶ï¼šé™åˆ¶User-Agentæœ€å¤§é•¿åº¦

### 8ï¸âƒ£ è¯·æ±‚å¤´å®‰å…¨æ£€æŸ¥
- âœ… å¯ç–‘å¤´æ£€æµ‹ï¼šè¯†åˆ«åŒ…å«å¯ç–‘å†…å®¹çš„è¯·æ±‚å¤´
- âœ… æ•°é‡é™åˆ¶ï¼šé™åˆ¶è¯·æ±‚å¤´æœ€å¤§æ•°é‡ï¼Œé˜²æ­¢å¤´æº¢å‡ºæ”»å‡»

### 9ï¸âƒ£ æ–‡ä»¶ä¸Šä¼ é˜²æŠ¤
- âœ… æ‰©å±•åè¿‡æ»¤ï¼šç¦æ­¢å±é™©æ–‡ä»¶æ‰©å±•åä¸Šä¼ ï¼ˆæ”¯æŒåŠ¨æ€é…ç½®ï¼‰
- âœ… MIMEç±»å‹è¿‡æ»¤ï¼šç¦æ­¢å±é™©MIMEç±»å‹çš„æ–‡ä»¶ä¸Šä¼ ï¼ˆæ”¯æŒåŠ¨æ€é…ç½®ï¼‰
- âœ… å¤§å°é™åˆ¶ï¼šé™åˆ¶ä¸Šä¼ æ–‡ä»¶æœ€å¤§ä½“ç§¯
- âœ… å†…å®¹æ‰«æï¼šå¯é€‰çš„æ–‡ä»¶å†…å®¹å®‰å…¨æ£€æŸ¥
- âœ… ç™½åå•æœºåˆ¶ï¼šå…è®¸ç‰¹å®šçš„å®‰å…¨æ–‡ä»¶ç±»å‹

### ğŸ”Ÿ é«˜çº§æ”»å‡»æ£€æµ‹
- âœ… å¼‚å¸¸è¡Œä¸ºæ£€æµ‹ï¼šæ£€æµ‹å¼‚å¸¸çš„è¯·æ±‚å‚æ•°å’Œè¡Œä¸ºæ¨¡å¼
- âœ… SQLæ³¨å…¥é˜²æŠ¤ï¼šä¸“é¡¹æ£€æµ‹SQLæ³¨å…¥æ”»å‡»ï¼ˆ200+æ¨¡å¼ï¼‰
- âœ… XSSæ”»å‡»é˜²æŠ¤ï¼šä¸“é¡¹æ£€æµ‹è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆ150+æ¨¡å¼ï¼‰
- âœ… å‘½ä»¤æ³¨å…¥é˜²æŠ¤ï¼šä¸“é¡¹æ£€æµ‹ç³»ç»Ÿå‘½ä»¤æ³¨å…¥æ”»å‡»ï¼ˆ100+æ¨¡å¼ï¼‰
- âœ… æ–°å…´å¨èƒæ£€æµ‹ï¼šè¦†ç›–ä¾›åº”é“¾æ”»å‡»ã€Web3æ”»å‡»ç­‰æ–°å‹å¨èƒ

### 1ï¸âƒ£1ï¸âƒ£ ç¼“å­˜ä¸å°ç¦æœºåˆ¶
- âœ… ç»“æœç¼“å­˜ï¼šå¤šå±‚ç¼“å­˜æå‡æ€§èƒ½
- âœ… æ™ºèƒ½å°ç¦ï¼šæ ¹æ®ä¸åŒå®‰å…¨äº‹ä»¶ç±»å‹è®¾ç½®ä¸åŒçš„å°ç¦æ—¶é•¿
- âœ… è‡ªé€‚åº”å°ç¦ï¼šæ ¹æ®å¨èƒè¯„åˆ†åŠ¨æ€è°ƒæ•´å°ç¦æ—¶é•¿ï¼ˆ2-10å€ï¼‰
- âœ… å°ç¦æ—¶é•¿é™åˆ¶ï¼šé˜²æ­¢è®¾ç½®è¿‡é•¿çš„å°ç¦æ—¶é—´

### 1ï¸âƒ£2ï¸âƒ£ å“åº”å¤„ç†
- âœ… å¼‚å¸¸å¤„ç†ï¼šå®Œå–„çš„å¼‚å¸¸æ•è·å’Œå¤„ç†æœºåˆ¶
- âœ… AJAXå“åº”ï¼šé’ˆå¯¹APIè¯·æ±‚çš„æ ‡å‡†åŒ–JSONå“åº”
- âœ… é”™è¯¯é¡µé¢ï¼šæ”¯æŒè‡ªå®šä¹‰æ‹¦æˆªé¡µé¢
- âœ… çŠ¶æ€ç æ˜ å°„ï¼šä¸åŒå®‰å…¨äº‹ä»¶è¿”å›ç›¸åº”çš„HTTPçŠ¶æ€ç 
- âœ… APIæ¨¡å¼ï¼šé’ˆå¯¹APIè¯·æ±‚çš„å“åº”ä¼˜åŒ–

### 1ï¸âƒ£3ï¸âƒ£ è‡ªå®šä¹‰æ‰©å±•
- âœ… è‡ªå®šä¹‰å¤„ç†ï¼šæ”¯æŒæ³¨å…¥è‡ªå®šä¹‰å®‰å…¨æ£€æŸ¥é€»è¾‘
- âœ… é»‘ç™½åå•å¤„ç†ï¼šå¯è‡ªå®šä¹‰é»‘ç™½åå•æ£€æŸ¥é€»è¾‘
- âœ… å®‰å…¨è­¦æŠ¥ï¼šæ”¯æŒè‡ªå®šä¹‰å®‰å…¨è­¦æŠ¥å‘é€æœºåˆ¶ï¼ˆé‚®ä»¶ã€é’‰é’‰ã€Slackç­‰ï¼‰
- âœ… è§„åˆ™å¼•æ“ï¼šæ”¯æŒè‡ªå®šä¹‰æ£€æµ‹è§„åˆ™å’Œå¨èƒè¯„åˆ†

### 1ï¸âƒ£4ï¸âƒ£ é˜²å¾¡å±‚ç®¡ç†
- âœ… åˆ†å±‚é˜²æŠ¤ï¼š14ä¸ªé˜²å¾¡å±‚å¯ç‹¬ç«‹å¼€å…³
- âœ… çµæ´»é…ç½®ï¼šå¯ç‹¬ç«‹æ§åˆ¶IPæ£€æŸ¥ã€æ–¹æ³•æ£€æŸ¥ã€å†…å®¹æ£€æŸ¥ç­‰å„ä¸ªé˜²æŠ¤æ¨¡å—
- âœ… æŒ‰åºæ‰§è¡Œï¼šé˜²å¾¡å±‚æŒ‰é…ç½®é¡ºåºä¾æ¬¡æ‰§è¡Œ

### 1ï¸âƒ£5ï¸âƒ£ å…¶ä»–ç‰¹æ€§
- âœ… é…ç½®çƒ­é‡è½½ï¼šé…ç½®ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯åº”ç”¨
- âœ… ä»£ç†æ”¯æŒï¼šæ”¯æŒé…ç½®ä¿¡ä»»çš„ä»£ç†æœåŠ¡å™¨
- âœ… æ€§èƒ½ç›‘æ§ï¼šç›‘æ§è¯·æ±‚æ—¶é—´ã€å†…å­˜ä½¿ç”¨ã€æ£€æµ‹å±‚è€—æ—¶
- âœ… å®‰å…¨å®¡è®¡ï¼šå®‰å…¨äº‹ä»¶è®°å½•å’Œå¨èƒè¶‹åŠ¿åˆ†æ

### 1ï¸âƒ£6ï¸âƒ£ é…ç½®ç®¡ç†
- âœ… ç¯å¢ƒå˜é‡è¦†ç›–ï¼šæ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡åŠ¨æ€è°ƒæ•´é…ç½®
- âœ… åŠ¨æ€é…ç½®æºï¼šæ”¯æŒä½¿ç”¨ç±»æ–¹æ³•ã€é—­åŒ…ã€æ•°ç»„ç­‰å¤šç§é…ç½®æ–¹å¼
- âœ… å®Œæ•´ç±»å‹æç¤ºï¼šæ‰€æœ‰é…ç½®é¡¹éƒ½æœ‰æ˜ç¡®çš„ç±»å‹å®šä¹‰å’Œé»˜è®¤å€¼
- âœ… ä¸­æ–‡æ³¨é‡Šï¼šæ‰€æœ‰é…ç½®é¡¹éƒ½æœ‰è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šå’Œè¯´æ˜

## ğŸ¯ æ ¸å¿ƒæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   HTTP Request                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SecurityMiddleware                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é…ç½®çƒ­é‡è½½                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  14å±‚é˜²å¾¡æ£€æŸ¥ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰                            â”‚  â”‚
â”‚  â”‚  01. IPç™½åå•æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  02. IPé»‘åå•æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  03. HTTPæ–¹æ³•æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  04. User-Agentæ£€æŸ¥                                 â”‚  â”‚
â”‚  â”‚  05. è¯·æ±‚å¤´æ£€æŸ¥                                      â”‚  â”‚
â”‚  â”‚  06. URLæ£€æŸ¥ï¼ˆå«ç™½åå•ï¼‰                              â”‚  â”‚
â”‚  â”‚  07. æ–‡ä»¶ä¸Šä¼ æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  08. è¯·æ±‚ä½“æ£€æŸ¥                                      â”‚  â”‚
â”‚  â”‚  09. å¼‚å¸¸å‚æ•°æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  10. é€Ÿç‡é™åˆ¶æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  11. SQLæ³¨å…¥æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  12. XSSæ”»å‡»æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  13. å‘½ä»¤æ³¨å…¥æ£€æŸ¥                                    â”‚  â”‚
â”‚  â”‚  14. è‡ªå®šä¹‰è§„åˆ™æ£€æŸ¥                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¼‚å¸¸ä¿æŠ¤ä¸é™çº§                                      â”‚  â”‚
â”‚  â”‚  - é€’å½’æ£€æµ‹                                         â”‚  â”‚
â”‚  â”‚  - å¼‚å¸¸æ•è·                                         â”‚  â”‚
â”‚  â”‚  - é™çº§æ”¾è¡Œ                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                   â”‚
               â–¼                   â–¼
             [æ‹¦æˆª]              [é€šè¿‡]
               â”‚                   â”‚
               â–¼                   â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  æ‹¦æˆªå“åº”      â”‚   â”‚   ç»§ç»­å¤„ç†     â”‚
       â”‚ (JSON/HTML)  â”‚    â”‚  ä¸‹ä¸€ä¸ªä¸­é—´ä»¶  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### å…¨å±€é˜²æŠ¤ï¼ˆæ¨èï¼‰
```php
// config/security.php
'enabled' => true,
'enabled_type' => 'global',

// å‘å¸ƒé…ç½®åæ— éœ€ä»»ä½•ä»£ç ä¿®æ”¹ï¼Œå…¨å±€è‡ªåŠ¨é˜²æŠ¤
```

### è·¯ç”±çº§é˜²æŠ¤
```php
// config/security.php
'enabled_type' => 'route',

// åœ¨è·¯ç”±ä¸­æ·»åŠ ä¸­é—´ä»¶
Route::middleware(['security'])->group(function () {
    Route::get('/api/users', [UserController::class, 'index']);
});
```

### è‡ªå®šä¹‰ç™½åå•
```php
// config/security.php
'url_whitelist_paths' => [
    // ç®€å•æ ¼å¼
    'robots.txt',
    'favicon.ico',

    // é«˜çº§æ ¼å¼ï¼ˆæ”¯æŒæ–¹æ³•é™åˆ¶å’Œçº§åˆ«æ§åˆ¶ï¼‰
    [
        'path' => 'api/health',
        'methods' => ['GET'],
        'level' => 'low'  // ä¿ç•™å¿…è¦çš„æ£€æŸ¥
    ],
    [
        'path' => 'api/status',
        'methods' => ['GET'],
        'level' => 'medium'
    ],
],
```

### è‡ªå®šä¹‰è§„åˆ™
```php
// config/security.php
'rule_engine' => [
    'custom_rules' => [
        [
            'id' => 'custom_001',
            'name' => 'è‡ªå®šä¹‰SQLæ³¨å…¥æ£€æµ‹',
            'pattern' => '/UNION\s+ALL\s+SELECT/i',
            'severity' => 'critical',
            'action' => 'block',
        ],
    ],
],
```

### è‡ªå®šä¹‰è­¦æŠ¥
```php
// app/Services/SecurityAlarmHandler.php
class SecurityAlarmHandler
{
    public static function send(array $alertData): void
    {
        // å‘é€é‚®ä»¶
        Mail::to('security@example.com')->send(new SecurityAlert($alertData));

        // å‘é€é’‰é’‰
        DingTalk::send($alertData);
    }
}

// config/security.php
'alarm_handler' => [SecurityAlarmHandler::class, 'send'],
```

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜é…ç½®
```php
'enable_pattern_cache' => true,   // æ­£åˆ™è¡¨è¾¾å¼ç¼“å­˜
'enable_ip_cache' => true,        // IPç¼“å­˜
'cache_ttl' => 3600,            // ç¼“å­˜1å°æ—¶
```

### æ€§èƒ½ç›‘æ§
```php
// è·å–å®‰å…¨ç»Ÿè®¡ä¿¡æ¯
$middleware = app(SecurityMiddleware::class);
$stats = $middleware->getSecurityStats();

// è¾“å‡º
// [
//     'detection_stats' => [
//         'total_requests' => 10000,
//         'blocked_requests' => 150,
//         'start_time' => 1234567890,
//         'end_time' => 1234567900,
//     ],
//     'rate_limits' => [...],
//     'recent_errors' => [...],
// ]
```

## ğŸ“‹ é…ç½®å‚è€ƒ

### ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®

```php
'enabled' => true,
'enabled_type' => 'global',
'log_level' => 'warning',
'enable_debug_logging' => false,
'block_on_exception' => true,
'enable_rate_limiting' => true,
'enable_sql_injection_detection' => true,
'enable_xss_detection' => true,
'enable_command_injection_detection' => true,
'ip_auto_detection' => [
    'enabled' => true,
    'blacklist_threshold' => 80.0,
    'adaptive_ban_duration' => true,
],
```

### å¼€å‘ç¯å¢ƒæ¨èé…ç½®

```php
'enabled' => true,
'enabled_type' => 'global',
'log_level' => 'debug',
'enable_debug_logging' => true,
'block_on_exception' => false,
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ“ è”ç³»æ–¹å¼

- ä½œè€…ï¼šzhaoxianfang
- é‚®ç®±ï¼šcontact@yoc.cn
- ç½‘ç«™ï¼šhttps://www.yoc.cn

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª Starï¼**
